clear all;
%wspczynniki filtrów wziête po obliczeniu plikiem "wspoczynniki_filtru.m"
load('referenceData\correctionFreqReference.mat');
load('modeleFiltrow\probkowanie_48000\filtrA_ss.mat')
load('modeleFiltrow\probkowanie_48000\filtrC_ss.mat')

[aMag,aPhase,aOmega] = bode(aModel,reference(:,1)'*2 * pi());
[cMag,cPhase,cOmega] = bode(cModel,reference(:,1)'*2 * pi());

%popraw u³o¿enie danych
aMag = aMag(:);aPhase = aPhase(:);aOmega = aOmega(:);
cMag = cMag(:);cPhase = cPhase(:);cOmega = cOmega(:);


display('wartoœæ[dB]        czêstotliwoœæ[Hz]')
for i = 1:length(reference(:,1)')
    
    string = num2str(db(aMag(i)));
    string = string + '  ' + 
    
    
    disp(string)    
    
end










return
%-------------INNY SPOSÓB----------


Fs = 48000;

endTime = 0.2;
time = 0:1/Fs:endTime -1/Fs;




%---------------------------------------sekwencja testowa START
for freq = reference(:,1)' %pozwala na generacje sinusów o kolejnych czêstotliwoœciach z reference
    disp('inicjalizacja dla czestotliwosci'),freq
    
    aStates = zeros(6,1); aStatesNext = zeros(6,1);
    aOutput = zeros(Fs*endTime,1);
    cStates = zeros(6,1); cStatesNext = zeros(6,1); 
    cOutput = zeros(Fs*endTime,1);
    %//////////////////////////////////////////////////generuj sygna³ testowy
   
   
    
    p = zeros(Fs*endTime,1); %inicjalizacja
    amplitude = 0.1;
    for i = 1:endTime*Fs
        t = i * 1/Fs - 1/Fs;
        p(i) = amplitude * sin(freq*2*pi()*t);  
    end
    %///////////////////////////////////// koniec generacji sygna³u testowego
     disp('sprawdzanie filtru dla zadanego sygna³u');
    %---------------------------START petla dzia³ania filtru na sygna³ 
    for i = 1:endTime*Fs
        i
        aStatesNext = aModel.a * aStates + aModel.b * p(i);
        aOutput(i) = aModel.c * aStates + aModel.d *p(i);
        aStates = aStatesNext;
    
    end
   
    scatter(time,aOutput);
    hold on;
    plot(time,p);
    pause;
    %---------------------------KONIEC petla dzia³ania filtru na sygna³ 
    
    
     disp(freq);

   
 end
%---------------------------------------sekwencja testowa KONIEC










